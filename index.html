<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <title>Laika</title>
</head>

<body>
    <div class="container d-flex justify-content-center">
        <div id="dogs">
        </div>
    </div>
    <div class="container">
        <button type="button" class="btn btn-success" id="start-btn">Start guessing!</button>
    </div>
    <script>
        let count = 0;
        let startBtn = document.getElementById("start-btn");
        startBtn.addEventListener("click", function(){
            getDogs();
        })
        
        function getDogs() {
            fetch("https://api-dog-breeds.herokuapp.com/api/dogs")
            .then(response => response.json())
            .then(data => {
                displayData(data);
                count++;
            })
        }

        function addElem(but, str) {
            const preItem = `
    <div class="card d-flex justify-content-center" style="width: 30rem;" id="dog-card">
        `;
            const postItem = "</div> </div>";
            let arr = [2,3,1,4];
            let randBut = Math.floor(Math.random() * 4) + 1;
            for (var i = 0; i < arr.length; i++){
                if(randBut == arr[i]){
                    arr.splice(i,1).pop(randBut)
                }
            }
            let thatNum = arr[2];
            let thatSecondNum = arr[1];
            let thatThirdNum = arr[0];
            document.getElementById("dogs").innerHTML += preItem + str + but.split("\n")[randBut] + but.split("\n")[thatNum] + but.split("\n")[thatSecondNum] + but.split("\n")[thatThirdNum] + postItem;

            

    }


        const displayData = (data) => {
            
            //for (var el of data) {
                let randNum = Math.floor(Math.random() * 100);
                addElem(
                    `<div style="flex-direction: column;" class="d-flex justify-content-center" id="btns">
                    <button id="correct" class="btn btn-primary rounded-pill mt-2" style="width: 15rem;">${data[count].breedName}</button>
                    <button id="incorrect" class="btn btn-primary rounded-pill mt-2" style="width: 15rem;">${randNum == data.indexOf(count) ? data[randNum+1]["breedName"] : data[randNum]["breedName"]}</button>
                    <button id="incorrect" class="btn btn-primary rounded-pill mt-2" style="width: 15rem;">${data[randNum +2]["breedName"]}</button>
                    <button id="incorrect" class="btn btn-primary rounded-pill mt-2" style="width: 15rem;">${data[randNum +3]["breedName"]}</button>
                    </div>`,
                    `
                    <img src="${data[count].image}" class="card-img-top" alt="...">
                    
                    
                    
                    `)
                
           // }
        }

        let btnDiv = document.getElementById("dogs");
        if(btnDiv){
            btnDiv.addEventListener("click", function(event) {
                if(event.target.id === "correct"){
                    event.target.classList.add("btn-success");
                    setTimeout(function(){
                        document.getElementById("dog-card").remove();
                        getDogs();
                    }, 2000)
                    
                }
                else if(event.target.id === "incorrect"){
                    event.target.classList.add("btn-danger");
                    setTimeout(function(){
                        document.getElementById("dog-card").remove();
                        getDogs();
                    }, 2000)
                }
            })
        }
      
    </script>
</body>

</html>